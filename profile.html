<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Profile | Neil Movies</title>
  <link rel="stylesheet" href="style.css">
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P53EGBMW3L"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P53EGBMW3L');
</script>
</head>
<body>

<nav class="navbar">
  <div class="nav-container">
    <a href="index.html" class="nav-logo">üé¨ Neil Movies</a>
    <ul class="nav-menu">
      <li><a href="index.html">Home</a></li>
      <li><a href="profile.html">My List</a></li>
    </ul>
  </div>
</nav>

<a href="index.html" class="nav-btn"><i class="fa-solid fa-house"></i>Back Home</a>
  </nav>

<div class="profile">
  <div class="profile-header">
    <div class="profile-avatar">üë§</div>
    <div class="profile-info">
      <h2>Welcome back</h2>
      <p>Your saved trailers</p>
    </div>
    <button id="logoutBtn">Logout</button>
  </div>

  <h3>Saved Movies</h3>
  <div class="movies" id="savedMovies"></div>
</div>
















<script type="module">
    import { auth } from "./js/firebase.js";
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const userEmail = document.getElementById("userEmail");
    const logoutBtn = document.getElementById("logoutBtn");

    // ‚úÖ Block access if not logged in
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        userEmail.textContent = `Logged in as: ${user.email}`;
      }
    });

    logoutBtn.addEventListener("click", async () => {
      await signOut(auth);
      window.location.href = "login.html";
    });
  </script>









<div class="movies" id="savedMovies"></div>
<script>
  // üîí protect profile
  if (localStorage.getItem("loggedIn") !== "true") {
    window.location.href = "login.html";
  }

  const container = document.getElementById("savedMovies");
  let saved = JSON.parse(localStorage.getItem("savedMovies")) || [];

  function renderSaved() {
    container.innerHTML = "";

    if (saved.length === 0) {
      container.innerHTML = "<p>No saved movies yet.</p>";
      return;
    }

    saved.forEach((movie, index) => {
      container.innerHTML += `
        <div class="movie-card">
          <a href="${movie.link}">
            <img src="${movie.image}">
            <h3>${movie.title}</h3>
          </a>
          <button class="remove-btn" onclick="removeMovie(${index})">
            ‚ùå Remove
          </button>
        </div>
      `;
    });
  }

  function removeMovie(index) {
    saved.splice(index, 1);
    localStorage.setItem("savedMovies", JSON.stringify(saved));
    renderSaved();
  }

  renderSaved();
</script>
<script>
  const container = document.getElementById("savedMovies");
  const saved = JSON.parse(localStorage.getItem("savedMovies")) || [];

  if (saved.length === 0) {
    container.innerHTML = "<p>No saved movies yet.</p>";
  } else {
    saved.forEach(movie => {
      container.innerHTML += `
        <a href="${movie.link}" class="movie-card">
          <img src="${movie.image}">
          <h3>${movie.title}</h3>
        </a>
      `;
    });
  }
</script>
<script>
  if (localStorage.getItem("loggedIn") !== "true") {
    window.location.href = "login.html";
  }
</script>

<script>
  document.getElementById("logoutBtn").addEventListener("click", () => {
    localStorage.removeItem("loggedIn");
    localStorage.removeItem("savedMovies");
    window.location.href = "login.html";
  });
</script>













<script type="module">
  import { auth } from "./firebase.js";
  import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  onAuthStateChanged(auth, (user) => {
    if (!user) {
      // not logged in
      window.location.href = "login.html";
      return;
    }

    if (!user.emailVerified) {
      alert("Please verify your email first.");
      window.location.href = "login.html";
      return;
    }

    // logged in + verified
    console.log("Access granted:", user.email);
  });
</script>











 <script type="module" src="js/profile.js"></script>
</body>
</html>